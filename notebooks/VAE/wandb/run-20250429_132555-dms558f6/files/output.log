JAX running on 1 devices
Global batch size: 32
Per-device batch size: 32
Starting training...
(1, 32, 784)
(1, 32)
(1, 4, 32, 16)
JAX running on 1 devices
Global batch size: 32
Per-device batch size: 32
2025-04-29 13:26:32.484148: W tensorflow/core/kernels/data/cache_dataset_ops.cc:858] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Starting training...
